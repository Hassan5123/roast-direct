(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(5155),a=r(2115),o=r(3819),n=r(6874),l=r.n(n),i=r(5695),c=r(3358),d=r(5374);let m=["Whole Bean","Aeropress","Espresso","Chemex","Cold Brew","Pour Over","French Press","Moka Pot","Auto Drip"];function u(){let e,t=(0,i.useParams)().productId,[r,n]=(0,a.useState)(null),[u,x]=(0,a.useState)(!0),[h,g]=(0,a.useState)(""),[p,f]=(0,a.useState)(1),[b,v]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[w,N]=(0,a.useState)(""),[k,C]=(0,a.useState)(!1),[S,_]=(0,a.useState)(!1),[I,L]=(0,a.useState)(""),{addToCart:E,items:P}=(0,c._)(),{isAuthenticated:M}=(0,d.A)(),O=(0,i.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{x(!0),g("");let e=await fetch("".concat("http://localhost:5002","/api/products/").concat(t));if(!e.ok){if(404===e.status)throw Error("Product not found");throw Error("Failed to load product details")}let r=await e.json();n(r.product)}catch(e){console.error("Error fetching product details:",e),g(e instanceof Error?e.message:"Unable to load product details")}finally{x(!1)}})()},[t]);let A=(0,a.useMemo)(()=>r?P.filter(e=>e.productId===r._id).reduce((e,t)=>e+t.quantity,0):0,[P,r]);(0,a.useMemo)(()=>{if(!r||!b)return 0;let e=P.find(e=>e.productId===r._id&&e.grindOption===b);return e?e.quantity:0},[P,r,b]);let D=(0,a.useMemo)(()=>r?Math.max(0,r.inventory_count-A):0,[r,A]),B=e=>{!(e<1)&&r&&(e>D?A>0?y("Sorry, only ".concat(D," more available (").concat(A," already in cart)")):y("Sorry, only ".concat(r.inventory_count," available in stock")):(y(""),f(e)))};return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 bg-amber-50",children:[(0,s.jsxs)(l(),{href:"/products",className:"flex items-center text-amber-700 hover:text-amber-800 mb-4",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Products"]}),u&&(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsxs)("div",{className:"animate-pulse flex flex-col items-center",children:[(0,s.jsx)("div",{className:"rounded-full bg-amber-200 h-12 w-12 mb-4"}),(0,s.jsx)("div",{className:"text-amber-800",children:"Loading product details..."})]})}),h&&!u&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6 flex items-center justify-center",children:[(0,s.jsx)("svg",{className:"h-5 w-5 text-red-600 mr-3",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,s.jsx)("p",{className:"text-red-700 font-medium",children:h})]}),!u&&!h&&r&&(0,s.jsx)("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:(0,s.jsxs)("div",{className:"md:flex",children:[(0,s.jsx)("div",{className:"md:w-1/3 h-48 relative bg-amber-100",children:(0,s.jsx)("img",{src:(0,o.a)(r._id),alt:r.name,className:"h-full w-full object-cover",onError:e=>(0,o.U)(e,r._id)})}),(0,s.jsxs)("div",{className:"md:w-2/3 p-4",children:[(0,s.jsxs)("div",{className:"uppercase tracking-wide text-sm text-amber-500 font-semibold",children:[r.origin_country," â€¢ ",r.roast_level," Roast"]}),(0,s.jsx)("h1",{className:"mt-2 text-3xl font-bold text-amber-900",children:r.name}),(0,s.jsx)("div",{className:"mt-2 text-xl text-amber-700 font-semibold",children:(e=r.price,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e))}),(0,s.jsxs)("div",{className:"mt-3 border-t border-gray-200 pt-2",children:[(0,s.jsx)("h2",{className:"text-sm font-bold text-gray-800",children:"Description"}),(0,s.jsx)("p",{className:"mt-1 text-gray-700 text-sm line-clamp-2",children:r.description})]}),(0,s.jsxs)("div",{className:"mt-2 border-t border-gray-200 pt-2",children:[(0,s.jsx)("h2",{className:"text-sm font-bold text-gray-800",children:"Farm Information"}),(0,s.jsx)("p",{className:"mt-1 text-gray-700 text-sm line-clamp-2",children:r.farm_info||"Information not available"})]}),(0,s.jsxs)("div",{className:"mt-2 border-t border-gray-200 pt-2",children:[(0,s.jsx)("h2",{className:"text-sm font-bold text-gray-800",children:"Details"}),(0,s.jsxs)("dl",{className:"mt-1 space-y-0.5",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("dt",{className:"text-sm font-bold text-gray-800",children:"Origin"}),(0,s.jsx)("dd",{className:"text-sm text-gray-700 col-span-2",children:r.origin_country})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("dt",{className:"text-sm font-bold text-gray-800",children:"Elevation"}),(0,s.jsxs)("dd",{className:"text-sm text-gray-700 col-span-2",children:[r.elevation," meters"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("dt",{className:"text-sm font-bold text-gray-800",children:"Processing"}),(0,s.jsx)("dd",{className:"text-sm text-gray-700 col-span-2",children:r.processing_method})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("dt",{className:"text-sm font-bold text-gray-800",children:"Roast Level"}),(0,s.jsx)("dd",{className:"text-sm text-gray-700 col-span-2",children:r.roast_level})]})]})]}),r.tasting_notes&&r.tasting_notes.length>0&&(0,s.jsxs)("div",{className:"mt-2 border-t border-gray-200 pt-2",children:[(0,s.jsx)("h2",{className:"text-sm font-bold text-gray-800 mb-1",children:"Tasting Notes"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:r.tasting_notes.map((e,t)=>(0,s.jsx)("span",{className:"bg-amber-50 text-amber-700 px-2 py-0.5 rounded-full text-xs",children:e},t))})]}),(0,s.jsxs)("div",{className:"mt-2 border-t border-gray-200 pt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h2",{className:"text-sm font-bold text-gray-800",children:["Quantity ",A>0&&(0,s.jsxs)("span",{className:"font-normal text-amber-600 text-xs ml-1",children:["(Already in cart: ",A,")"]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{onClick:()=>B(p-1),disabled:p<=1,className:"p-1 border border-gray-300 rounded-l-md hover:bg-gray-100 disabled:opacity-50 text-black",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,s.jsx)("input",{type:"number",min:"1",max:r.inventory_count,value:p,onChange:e=>B(parseInt(e.target.value)||1),className:"w-12 text-center border-t border-b border-gray-300 p-1 text-black"}),(0,s.jsx)("button",{onClick:()=>B(p+1),disabled:D<=p,className:"p-1 border border-gray-300 rounded-r-md hover:bg-gray-100 disabled:opacity-50 text-black",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),j&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:j}),!j&&D>0&&(0,s.jsxs)("p",{className:"mt-1 text-xs text-gray-600",children:["In stock: ",r.inventory_count," ",A>0&&"(".concat(D," available to add)")]}),0===D&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-600",children:"Maximum quantity already in cart"})]}),(0,s.jsxs)("div",{className:"mt-2 border-t border-gray-200 pt-2",children:[(0,s.jsx)("h2",{className:"text-sm font-bold text-gray-800 mb-1",children:"Grind Option"}),(0,s.jsxs)("select",{value:b,onChange:e=>{v(e.target.value),e.target.value&&N("")},className:"block w-full rounded-md border ".concat(!b&&"border-red-300"," border-gray-300 py-1 px-3 text-sm text-black focus:outline-none focus:ring-amber-500 focus:border-amber-500"),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"Select a grind option"}),m.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{className:"mt-2",children:[w&&(0,s.jsx)("p",{className:"text-sm text-red-600 mb-1",children:w}),I&&(0,s.jsxs)("div",{className:"mb-2 bg-red-100 border border-red-400 text-red-700 px-3 py-1 rounded flex items-center text-sm",children:[(0,s.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),I,(0,s.jsx)("button",{className:"ml-2 underline text-red-800 hover:text-red-900",onClick:()=>O.push("/login"),children:"Login now"})]}),S&&(0,s.jsxs)("div",{className:"mb-2 bg-green-100 border border-green-400 text-green-700 px-3 py-1 rounded flex items-center text-sm",children:[(0,s.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Added to cart!"]}),(0,s.jsx)("button",{className:"w-full bg-amber-700 text-white py-1.5 px-4 rounded-md hover:bg-amber-800 focus:outline-none focus:ring-1 focus:ring-amber-500 focus:ring-offset-1 transition-colors duration-300 flex items-center justify-center text-sm",disabled:0===D||k,onClick:()=>{if(L(""),!M)return void L("You need to login to add items to cart");if(!b)return void N("Please select a grind option");if(!j){if(r&&p>D)return void y("Cannot add ".concat(p," items. Only ").concat(D," more available."));r&&p>0&&(C(!0),setTimeout(()=>{let e=P.find(e=>e.productId===r._id&&e.grindOption===b),t=e?e.quantity+p:p;E({productId:r._id,name:r.name,price:r.price,quantity:t,grindOption:b,imageUrl:(0,o.a)(r._id)}),_(!0),C(!1),setTimeout(()=>{_(!1)},3e3)},500))}},children:k?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Adding..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),D>0?"Add to Cart":r.inventory_count>0?"Maximum in Cart":"Out of Stock"]})}),(0,s.jsx)("div",{className:"flex justify-center mt-2",children:(0,s.jsxs)("button",{onClick:()=>O.push("/cart"),className:"text-amber-700 text-sm hover:underline flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"View Cart"]})})]})]})]})})]})}},3358:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>l,_:()=>n});var s=r(5155),a=r(2115);let o=(0,a.createContext)(void 0);function n(){let e=(0,a.useContext)(o);if(!e)throw Error("useCart must be used within a CartProvider");return e}function l(e){let{children:t}=e,[r,n]=(0,a.useState)([]);return(0,a.useEffect)(()=>{try{let e=localStorage.getItem("roastDirectCart");e&&n(JSON.parse(e))}catch(e){console.error("Failed to load cart from localStorage:",e)}},[]),(0,a.useEffect)(()=>{try{localStorage.setItem("roastDirectCart",JSON.stringify(r))}catch(e){console.error("Failed to save cart to localStorage:",e)}},[r]),(0,s.jsx)(o.Provider,{value:{items:r,addToCart:e=>{n(t=>{let r=t.findIndex(t=>t.productId===e.productId&&t.grindOption===e.grindOption);if(!(r>-1))return[...t,e];{let s=[...t];return s[r]={...s[r],quantity:e.quantity},s}})},removeFromCart:(e,t)=>{n(r=>r.filter(r=>r.productId!==e||r.grindOption!==t))},updateQuantity:(e,t,r)=>!(r<1)&&(n(s=>s.map(s=>s.productId===e&&s.grindOption===t?{...s,quantity:r}:s)),!0),clearCart:()=>{n([])},getCartTotal:()=>r.reduce((e,t)=>e+t.price*t.quantity,0),getItemCount:()=>r.reduce((e,t)=>e+t.quantity,0)},children:t})}},3819:(e,t,r)=>{"use strict";r.d(t,{U:()=>a,a:()=>s});let s=e=>{let t=window.location.origin;return"".concat(t,"/web-images/product-images/").concat(e,".jpg")},a=(e,t)=>{let r=[".webp",".jpeg",".png"],s=e.currentTarget,a=window.location.origin,o=parseInt(s.getAttribute("data-attempt")||"0",10);if(o<r.length)s.setAttribute("data-attempt",(o+1).toString()),s.src="".concat(a,"/web-images/product-images/").concat(t).concat(r[o]);else if(s.onerror=null,s.style.display="none",s.parentElement){s.parentElement.classList.add("flex","items-center","justify-center");let e=document.createElement("span");e.className="text-amber-700",e.textContent="No image available",s.parentElement.appendChild(e)}}},4866:(e,t,r)=>{Promise.resolve().then(r.bind(r,522))},5374:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,AuthProvider:()=>i});var s=r(5155),a=r(2115),o=r(5695);let n=(0,a.createContext)(void 0);function l(){let e=(0,a.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function i(e){let{children:t}=e,[r,l]=(0,a.useState)(!1),[i,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(null),u=(0,o.useRouter)(),x=(0,o.usePathname)();(0,a.useEffect)(()=>{let e=()=>{try{let e=localStorage.getItem("roastDirectAuth");l("true"===e);let t=localStorage.getItem("userData");t?m(JSON.parse(t)):m(null)}catch(e){console.error("Failed to check auth status:",e),l(!1),m(null)}finally{c(!1)}};e();let t=t=>{"roastDirectAuth"===t.key&&e()};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]),(0,a.useEffect)(()=>{i||r||["/cart"].some(e=>x.startsWith(e))&&u.push("/login")},[r,i,x,u]);let h=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5002","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)return!1;let s=await r.json();return localStorage.setItem("roastDirectAuth","true"),localStorage.setItem("authToken",s.token),localStorage.setItem("userData",JSON.stringify(s.user)),l(!0),m(s.user),!0}catch(e){return console.error("Login error:",e),!1}};return(0,s.jsx)(n.Provider,{value:{isAuthenticated:r,login:h,logout:()=>{localStorage.removeItem("roastDirectAuth"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),l(!1),m(null),u.push("/login")},checkingAuth:i,user:d},children:t})}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=4866)),_N_E=e.O()}]);