(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[560],{1469:(e,s,r)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var r in s)Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}(s,{default:function(){return d},getImageProps:function(){return l}});let t=r(8229),a=r(8883),n=r(3063),i=t._(r(1193));function l(e){let{props:s}=(0,a.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(s))void 0===r&&delete s[e];return{props:s}}let d=n.Image},4370:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>o});var t=r(5155),a=r(2115),n=r(5695),i=r(6874),l=r.n(i),d=r(6766);function o(){let[e,s]=(0,a.useState)(null),[r,i]=(0,a.useState)(!0),[o,c]=(0,a.useState)(""),[m,h]=(0,a.useState)(!1),[x,u]=(0,a.useState)(!1),[g,p]=(0,a.useState)(""),f=(0,n.useRouter)(),b=(0,n.useParams)(),j=null==b?void 0:b.orderId;if((0,a.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("authToken");if(!e)return void f.push("/login");if(!j)return void c("Order ID not found");let r=await fetch("".concat("http://localhost:5002","/api/orders/").concat(j),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok){if(401===r.status){localStorage.removeItem("authToken"),f.push("/login");return}if(403===r.status)return void c("You are not authorized to view this order");if(404===r.status)return void c("Order not found");throw Error("Failed to fetch order details")}let t=await r.json();s(t.order)}catch(e){console.error("Error fetching order details:",e),c(e.message||"Failed to load order details")}finally{i(!1)}})()},[f,j]),r)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading order details..."})]})});if(o||!e)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-red-600 mb-4",children:o||"Order not found"}),(0,t.jsx)(l(),{href:"/orders",className:"bg-amber-600 text-white px-4 py-2 rounded-md hover:bg-amber-700",children:"Back to Orders"})]})});let y=async()=>{if(j){u(!0);try{let r=localStorage.getItem("authToken");if(!r)return void f.push("/login");let t=await fetch("".concat("http://localhost:5002","/api/orders/cancel/").concat(j),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(!t.ok){if(401===t.status){localStorage.removeItem("authToken"),f.push("/login");return}let e=await t.json();throw Error(e.error||"Failed to cancel order")}await t.json(),e&&s({...e,status:"canceled"}),p("Order has been successfully canceled.")}catch(e){console.error("Error canceling order:",e),c(e.message||"Failed to cancel order")}finally{u(!1),h(!1)}}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[m&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6 shadow-xl",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cancel Order"}),(0,t.jsx)("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to cancel this order? This action cannot be undone and inventory will be restored."}),(0,t.jsxs)("div",{className:"flex space-x-3 justify-end",children:[(0,t.jsx)("button",{className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",onClick:()=>h(!1),disabled:x,children:"No, Keep Order"}),(0,t.jsx)("button",{className:"px-4 py-2 ".concat(x?"bg-gray-400":"bg-red-600 hover:bg-red-700"," text-white rounded-md transition-colors"),onClick:y,disabled:x,children:x?"Canceling...":"Yes, Cancel Order"})]})]})}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsxs)(l(),{href:"/orders",className:"text-amber-600 hover:text-amber-700 flex items-center text-sm font-medium",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Orders"]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Order #",e.order_number]}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:["Placed on ",new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),(0,t.jsx)("div",{className:"mt-4 sm:mt-0",children:(0,t.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e.toLowerCase()){case"in-progress":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";case"canceled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("-"," ")})})]})]}),(0,t.jsxs)("div",{className:"grid gap-8 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Order Items"}),(0,t.jsx)("div",{className:"space-y-6",children:e.items.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start space-x-4 pb-6 border-b border-gray-200 last:border-b-0 last:pb-0",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden relative",children:e.image_url?(0,t.jsx)(d.default,{src:e.image_url.startsWith("http")?e.image_url:"/products/".concat(e.image_url),alt:e.product_name,fill:!0,sizes:"(max-width: 80px) 100vw, 80px",className:"object-cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/web-images/placeholder-coffee.png"}}):(0,t.jsx)("div",{className:"text-gray-400",children:(0,t.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.product_name}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,t.jsxs)("p",{children:["Grind: ",e.grind_option]}),(0,t.jsxs)("p",{children:["Quantity: ",e.quantity]}),(0,t.jsxs)("p",{children:["Price: $",e.price_at_time.toFixed(2)," each"]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"font-medium text-gray-900",children:["$",e.item_total.toFixed(2)]})})]},s))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Shipping Address"}),(0,t.jsxs)("div",{className:"text-gray-700",children:[(0,t.jsx)("p",{children:e.shipping_address.street}),(0,t.jsxs)("p",{children:[e.shipping_address.city,", ",e.shipping_address.state," ",e.shipping_address.zip]}),e.shipping_address.country&&(0,t.jsx)("p",{children:e.shipping_address.country})]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["Items (",e.items.reduce((e,s)=>e+s.quantity,0),")"]}),(0,t.jsxs)("span",{className:"text-gray-900",children:["$",e.items.reduce((e,s)=>e+s.item_total,0).toFixed(2)]})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-3",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"Total"}),(0,t.jsxs)("span",{className:"text-lg font-semibold text-gray-900",children:["$",e.final_total.toFixed(2)]})]})})]})]}),e.payment_info&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Method"}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 capitalize",children:e.payment_info.payment_method}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["•••• ",e.payment_info.last_four]})]})]})]}),("in-progress"===e.status||"processing"===e.status)&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Actions"}),g?(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded relative mb-4",children:(0,t.jsx)("span",{className:"block sm:inline",children:g})}):(0,t.jsx)("button",{className:"w-full ".concat(x?"bg-gray-400":"bg-red-600 hover:bg-red-700"," text-white px-4 py-2 rounded-md transition-colors text-sm font-medium"),onClick:()=>h(!0),disabled:x,children:x?"Canceling...":"Cancel Order"})]})]})]})]})]})}},5695:(e,s,r)=>{"use strict";var t=r(8999);r.o(t,"useParams")&&r.d(s,{useParams:function(){return t.useParams}}),r.o(t,"usePathname")&&r.d(s,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}})},6610:(e,s,r)=>{Promise.resolve().then(r.bind(r,4370))},6766:(e,s,r)=>{"use strict";r.d(s,{default:()=>a.a});var t=r(1469),a=r.n(t)}},e=>{e.O(0,[874,63,441,964,358],()=>e(e.s=6610)),_N_E=e.O()}]);