(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{3080:(e,t,r)=>{Promise.resolve().then(r.bind(r,9690))},5374:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,AuthProvider:()=>i});var s=r(5155),a=r(2115),o=r(5695);let l=(0,a.createContext)(void 0);function n(){let e=(0,a.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function i(e){let{children:t}=e,[r,n]=(0,a.useState)(!1),[i,u]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null),m=(0,o.useRouter)(),h=(0,o.usePathname)();(0,a.useEffect)(()=>{let e=()=>{try{let e=localStorage.getItem("roastDirectAuth");n("true"===e);let t=localStorage.getItem("userData");t?c(JSON.parse(t)):c(null)}catch(e){console.error("Failed to check auth status:",e),n(!1),c(null)}finally{u(!1)}};e();let t=t=>{"roastDirectAuth"===t.key&&e()};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]),(0,a.useEffect)(()=>{i||r||["/cart"].some(e=>h.startsWith(e))&&m.push("/login")},[r,i,h,m]);let x=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5002","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)return!1;let s=await r.json();return localStorage.setItem("roastDirectAuth","true"),localStorage.setItem("authToken",s.token),localStorage.setItem("userData",JSON.stringify(s.user)),n(!0),c(s.user),!0}catch(e){return console.error("Login error:",e),!1}};return(0,s.jsx)(l.Provider,{value:{isAuthenticated:r,login:x,logout:()=>{localStorage.removeItem("roastDirectAuth"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),n(!1),c(null),m.push("/login")},checkingAuth:i,user:d},children:t})}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},9690:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(5155),a=r(2115),o=r(5695),l=r(6874),n=r.n(l),i=r(5374);function u(){let e=(0,o.useRouter)(),{login:t,isAuthenticated:r}=(0,i.A)();(0,a.useEffect)(()=>{r&&e.push("/products")},[r,e]);let[l,u]=(0,a.useState)({email:"",password:""}),[d,c]=(0,a.useState)({email:"",password:""}),[m,h]=(0,a.useState)(""),[x,g]=(0,a.useState)(!1),p=e=>{let{name:t,value:r}=e.target;u(e=>({...e,[t]:r})),d[t]&&c(e=>({...e,[t]:""})),m&&h("")},f=async e=>{if(e.preventDefault(),(()=>{let e=!0,t={email:"",password:""};return l.email.trim()||(t.email="Email is required",e=!1),l.password||(t.password="Password is required",e=!1),c(t),e})()){g(!0),h("");try{if(!await t(l.email,l.password))throw Error("Invalid email or password. Please try again.")}catch(e){e instanceof Error?h(e.message):h("An unexpected error occurred. Please try again later.")}finally{g(!1)}}};return(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 bg-amber-50",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-amber-900 mb-6 text-center",children:"Log In to Your Account"}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-amber-100",children:[(0,s.jsxs)("div",{className:"p-8",children:[m&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6 flex items-center",children:[(0,s.jsx)("svg",{className:"h-5 w-5 text-red-600 mr-3",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,s.jsx)("p",{className:"text-red-700 font-medium",children:m})]}),(0,s.jsxs)("form",{onSubmit:f,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",value:l.email,onChange:p,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-800 ".concat(d.email?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-amber-200")}),d.email&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.email})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,s.jsx)("input",{id:"password",name:"password",type:"password",value:l.password,onChange:p,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-800 ".concat(d.password?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-amber-200")}),d.password&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.password})]}),(0,s.jsx)("button",{type:"submit",disabled:x,className:"w-full bg-amber-700 text-white py-2 px-4 rounded-md hover:bg-amber-800 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-colors duration-300 disabled:opacity-50",children:x?"Logging in...":"Log In"})]})]}),(0,s.jsx)("div",{className:"px-8 py-4 bg-gray-50 border-t border-gray-200",children:(0,s.jsxs)("p",{className:"text-sm text-center text-gray-600",children:["Don't have an account? ",(0,s.jsx)(n(),{href:"/signup",className:"text-amber-700 hover:text-amber-800 font-semibold",children:"Sign up"})]})})]})]})})}}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=3080)),_N_E=e.O()}]);