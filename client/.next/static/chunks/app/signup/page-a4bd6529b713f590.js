(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{5374:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,AuthProvider:()=>i});var a=r(5155),s=r(2115),o=r(5695);let n=(0,s.createContext)(void 0);function l(){let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function i(e){let{children:t}=e,[r,l]=(0,s.useState)(!1),[i,m]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),u=(0,o.useRouter)(),h=(0,o.usePathname)();(0,s.useEffect)(()=>{let e=()=>{try{let e=localStorage.getItem("roastDirectAuth");l("true"===e);let t=localStorage.getItem("userData");t?c(JSON.parse(t)):c(null)}catch(e){console.error("Failed to check auth status:",e),l(!1),c(null)}finally{m(!1)}};e();let t=t=>{"roastDirectAuth"===t.key&&e()};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]),(0,s.useEffect)(()=>{i||r||["/cart"].some(e=>h.startsWith(e))&&u.push("/login")},[r,i,h,u]);let f=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5002","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)return!1;let a=await r.json();return localStorage.setItem("roastDirectAuth","true"),localStorage.setItem("authToken",a.token),localStorage.setItem("userData",JSON.stringify(a.user)),l(!0),c(a.user),!0}catch(e){return console.error("Login error:",e),!1}};return(0,a.jsx)(n.Provider,{value:{isAuthenticated:r,login:f,logout:()=>{localStorage.removeItem("roastDirectAuth"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),l(!1),c(null),u.push("/login")},checkingAuth:i,user:d},children:t})}},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},7573:(e,t,r)=>{Promise.resolve().then(r.bind(r,9349))},9349:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(5155),s=r(2115),o=r(5695),n=r(6874),l=r.n(n),i=r(5374);function m(){let e=(0,o.useRouter)(),{login:t,isAuthenticated:r}=(0,i.A)();(0,s.useEffect)(()=>{r&&e.push("/products")},[r,e]);let[n,m]=(0,s.useState)({first_name:"",last_name:"",email:"",password:""}),[d,c]=(0,s.useState)({first_name:"",last_name:"",email:"",password:""}),[u,h]=(0,s.useState)(""),[f,x]=(0,s.useState)(!1),g=e=>{let{name:t,value:r}=e.target;m(e=>({...e,[t]:r})),d[t]&&c(e=>({...e,[t]:""})),u&&h("")},p=async e=>{if(e.preventDefault(),(()=>{let e=!0,t={first_name:"",last_name:"",email:"",password:""};return n.first_name.trim()||(t.first_name="First name is required",e=!1),n.last_name.trim()||(t.last_name="Last name is required",e=!1),n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(t.email="Please enter a valid email address",e=!1):(t.email="Email is required",e=!1),n.password?n.password.length<8&&(t.password="Password must be at least 8 characters long",e=!1):(t.password="Password is required",e=!1),c(t),e})()){x(!0),h("");try{let e,r=await fetch("".concat("http://localhost:5002","/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});try{e=await r.json()}catch(e){throw Error("Unable to connect to the server. Please try again later.")}if(!r.ok)if(409===r.status)throw Error("An account with this email already exists. Please use a different email or try logging in.");else if(400===r.status)throw Error("Please check your information and try again. All fields are required.");else if(404===r.status)throw Error("The registration service is currently unavailable. Please try again later.");else throw Error(e.error||"Unable to create account. Please try again later.");await t(n.email,n.password)}catch(e){e instanceof Error?h(e.message):h("An unexpected error occurred. Please try again later.")}finally{x(!1)}}};return(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 bg-amber-50",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-amber-900 mb-6 text-center",children:"Create an Account"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-amber-100",children:[(0,a.jsxs)("div",{className:"p-8",children:[u&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6 flex items-center",children:[(0,a.jsx)("svg",{className:"h-5 w-5 text-red-600 mr-3",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsx)("p",{className:"text-red-700 font-medium",children:u})]}),(0,a.jsxs)("form",{onSubmit:p,children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),(0,a.jsx)("input",{id:"first_name",name:"first_name",type:"text",value:n.first_name,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-800 ".concat(d.first_name?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-amber-200")}),d.first_name&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.first_name})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),(0,a.jsx)("input",{id:"last_name",name:"last_name",type:"text",value:n.last_name,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-800 ".concat(d.last_name?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-amber-200")}),d.last_name&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.last_name})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",value:n.email,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-800 ".concat(d.email?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-amber-200")}),d.email&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.email})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",value:n.password,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 text-gray-800 ".concat(d.password?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-amber-200")}),d.password&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.password})]}),(0,a.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-amber-700 text-white py-2 px-4 rounded-md hover:bg-amber-800 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-colors duration-300 disabled:opacity-50",children:f?"Creating Account...":"Create Account"})]})]}),(0,a.jsx)("div",{className:"px-8 py-4 bg-gray-50 border-t border-gray-200",children:(0,a.jsxs)("p",{className:"text-sm text-center text-gray-600",children:["Already have an account? ",(0,a.jsx)(l(),{href:"/login",className:"text-amber-700 hover:text-amber-800 font-semibold",children:"Log in"})]})})]})]})})}}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=7573)),_N_E=e.O()}]);